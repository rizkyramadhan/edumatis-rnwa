{"version":3,"file":"static/webpack/static/development/pages/index.js.942692bf709d04878fdb.hot-update.js","sources":["webpack:///./pages/app/screens/siswa/Kewajiban/KewajibanDetail.tsx"],"sourcesContent":["import createRecord from \"@app/libs/queries/crud/createRecord\";\nimport { getSession } from \"@app/libs/queries/user/getsetSession\";\nimport UIContainer from \"@app/libs/ui/UIContainer\";\nimport UIHead from \"@app/libs/ui/UIHead\";\nimport UIWebView from \"@app/libs/ui/UIWebView\";\nimport { toJS } from \"mobx\";\nimport { observer, useObservable } from \"mobx-react-lite\";\nimport React, { useEffect } from \"react\";\nimport { ActivityIndicator, View, Text } from \"react-native\";\n\nexport default observer(({ navigation }: any) => {\n  const data = useObservable({\n    loading: true,\n    form: navigation.getParam(\"item\")\n  });\n  let transaksi: any = {};\n  if (data.form.transaksi.length > 0) {\n    transaksi = data.form.transaksi[0];\n  }\n  console.log(transaksi);\n  useEffect(() => {\n    const req = async function() {\n      const session = await getSession();\n      if (\n        !transaksi ||\n        (data.form.status === \"Belum Lunas\" &&\n          transaksi &&\n          transaksi.detail.amount !== data.form.nominal)\n      ) {\n        data.form.transaksi[0].detail = null;\n        var params: any = {\n          external_id: data.form.id,\n          payer_email: session.murid.email || `j@edumatis.id`,\n          description: data.form.nama_kewajiban,\n          amount: data.form.nominal\n        };\n\n        var myHeaders = new Headers();\n        myHeaders.append(\"pragma\", \"no-cache\");\n        myHeaders.append(\"cache-control\", \"no-cache\");\n        const response: Response = await fetch(\n          `http://backend.cap.edumatis.id/invoice`,\n          {\n            method: \"POST\",\n            body: JSON.stringify(params),\n            headers: myHeaders\n          }\n        );\n        const json = await response.json();\n\n        let res = await createRecord(\"transaksi\", {\n          kewajiban_id: toJS(data.form.id),\n          detail: json\n        });\n        data.form.transaksi.push({ id: res, detail: json });\n      }\n      data.loading = false;\n    };\n    req();\n  }, []);\n\n  return (\n    <UIContainer style={{ backgroundColor: \"#F5FAFD\" }}>\n      <UIHead\n        title={\n          ` Kewajiban ` +\n          (data.form.id\n            ? `#${data.form.id}: ${data.form.nama_kewajiban} (${\n                data.form.status\n              })`\n            : `Baru`)\n        }\n        onBack={() => {\n          navigation.goBack();\n        }}\n      />\n      <View\n        style={{\n          flex: 1,\n          padding: 10,\n          alignItems: \"center\",\n          justifyContent: \"center\"\n        }}\n      >\n        <ActivityIndicator\n          size=\"large\"\n          style={{ position: \"absolute\" }}\n          color=\"#999\"\n        />\n        <Text>\n          {!!transaksi.detail ? \"Creating Invoice...\" : \"Loading Invoice...\"}\n        </Text>\n        {transaksi.detail && (\n          <UIWebView\n            style={{\n              flex: 1,\n              position: \"absolute\",\n              width: \"100%\",\n              height: \"100%\",\n              zIndex: 99\n            }}\n            source={{\n              html: `<iframe width=\"100%\" height=\"100%\" src=\"${\n                transaksi.detail.invoice_url\n              }\"  frameborder=\"0\"></iframe>`\n            }}\n          />\n        )}\n      </View>\n    </UIContainer>\n  );\n});\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AACA;AAOA;AACA;AACA;AACA;AACA;AACA;AAJA;AAOA;AACA;AACA;AAlBA;AAAA;AAsBA;AACA;AACA;AAHA;AACA;AAtBA;AAmBA;AAnBA;AAAA;AACA;AADA;AA2BA;AA3BA;AAAA;AA8BA;AACA;AAFA;AACA;AA9BA;AA6BA;AAIA;AAAA;AAAA;AAAA;AACA;AAlCA;AAmCA;AACA;AApCA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAoCA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAQA;AACA;AACA;AAXA;AAAA;AAAA;AAAA;AAAA;AAAA;AAcA;AACA;AACA;AACA;AACA;AAJA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AAAA;AAAA;AACA;AAHA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AADA;AARA;AAAA;AAAA;AAAA;AAAA;AAAA;AAkBA;;;;A","sourceRoot":""}