{"version":3,"file":"static/webpack/static/development/pages/index.js.ea27e793c83f8c46ca6f.hot-update.js","sources":["webpack:///./pages/app/screens/siswa/Kewajiban/KewajibanDetail.tsx"],"sourcesContent":["import createRecord from \"@app/libs/queries/crud/createRecord\";\nimport { getSession } from \"@app/libs/queries/user/getsetSession\";\nimport UIBody from \"@app/libs/ui/UIBody\";\nimport UIContainer from \"@app/libs/ui/UIContainer\";\nimport UIHead from \"@app/libs/ui/UIHead\";\nimport UIWebView from \"@app/libs/ui/UIWebView\";\nimport { toJS } from \"mobx\";\nimport { observer, useObservable } from \"mobx-react-lite\";\nimport React, { useEffect } from \"react\";\nimport { Text, View } from \"react-native\";\n\nexport default observer(({ navigation }: any) => {\n  const data = useObservable({\n    loading: true,\n    form: navigation.getParam(\"item\")\n  });\n  let transaksi: any = {};\n  if (data.form.transaksi.length > 0) {\n    transaksi = data.form.transaksi[0];\n  }\n  console.log(toJS(transaksi));\n  useEffect(() => {\n    const req = async function() {\n      const session = await getSession();\n      if (data.form.transaksi.length === 0) {\n        var params: any = {\n          external_id: data.form.id,\n          payer_email: session.murid.email || `j@edumatis.id`,\n          description: data.form.nama_kewajiban,\n          amount: data.form.nominal\n        };\n\n        var myHeaders = new Headers();\n        myHeaders.append(\"pragma\", \"no-cache\");\n        myHeaders.append(\"cache-control\", \"no-cache\");\n        const response: Response = await fetch(\n          `http://backend.cap.edumatis.id/invoice`,\n          {\n            method: \"POST\",\n            body: JSON.stringify(params),\n            headers: myHeaders\n          }\n        );\n        const json = await response.json();\n\n        let res = await createRecord(\"transaksi\", {\n          kewajiban_id: toJS(data.form.id),\n          detail: json\n        });\n        data.form.transaksi.push({ id: res, detail: json });\n      }\n      data.loading = false;\n    };\n    req();\n  }, []);\n\n  return (\n    <UIContainer>\n      <UIHead\n        title={\n          ` Kewajiban ` +\n          (data.form.id\n            ? `#${data.form.id}: ${data.form.nama_kewajiban}`\n            : `Baru`)\n        }\n        onBack={() => {\n          navigation.goBack();\n        }}\n      />\n      <View style={{ flex: 1, padding: 10 }}>\n        <Text>Status: {data.form.status} </Text>\n        {transaksi.detail && (\n          <UIWebView\n            style={{ flex: 1 }}\n            source={{\n              html: `<iframe \n            width=\"100%\" height=\"100%\"\n             src=\"${transaksi.detail.invoice_url}\" \n             frameborder=\"0\" allow=\"autoplay;\n              encrypted-media\" allowfullscreen></iframe>`\n            }}\n          />\n        )}\n      </View>\n    </UIContainer>\n  );\n});\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AAAA;AACA;AACA;AACA;AAFA;AAIA;AACA;AAAA;AACA;AACA;AACA;AAAA;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AACA;AACA;AAFA;AAAA;AAAA;AAAA;AACA;AAEA;AACA;AACA;AACA;AACA;AAJA;AAOA;AACA;AACA;AAZA;AAAA;AAgBA;AACA;AACA;AAHA;AACA;AAhBA;AAaA;AAbA;AAAA;AACA;AADA;AAqBA;AArBA;AAAA;AAwBA;AACA;AAFA;AACA;AAxBA;AAuBA;AAIA;AAAA;AAAA;AAAA;AACA;AA5BA;AA6BA;AACA;AA9BA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AA8BA;AACA;AAEA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAMA;AACA;AACA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAGA;AAAA;AAAA;AACA;AACA;AADA;AAFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAcA;;;;A","sourceRoot":""}